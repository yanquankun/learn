## 1. 常见 Web 前端安全风险/攻击方式及危害

1. **XSS（跨站脚本攻击）**

   - **危害**：攻击者通过注入恶意脚本，窃取用户 Cookie、会话、敏感信息，甚至劫持页面操作。

2. **CSRF（跨站请求伪造）**

   - **危害**：攻击者诱导用户在已认证站点执行非法操作（如转账、改密），危害账户和数据安全。

3. **敏感信息泄露**

   - **危害**：如源码泄漏、接口暴露敏感参数、前端日志输出敏感信息，导致用户数据或系统机密外泄。

4. **依赖库/第三方 SDK 漏洞**

   - **危害**：前端引入的第三方依赖或 SDK 存在高危漏洞，被攻击者利用，造成资产或数据损失。

5. **点击劫持（Clickjacking）**
   - **危害**：在恶意页面内嵌入业务页面，诱导用户误点击，造成隐私泄露或操作被劫持。

---

## 2. 各类风险的前端防护措施

### XSS 防护

- **严格过滤、转义用户输入**
  - 展示用户内容前使用 `innerText`、`textContent`，避免用 `innerHTML`。
  - 富文本展示需白名单过滤标签和属性。
- **使用可信 DOM 操作 API**
  - 尽量避免直接拼接字符串生成 DOM。
- **开启 HttpOnly、Secure Cookie，减少被盗风险**
- **设置响应头**
  - `Content-Security-Policy` (CSP) 限制脚本来源。
  - 例：
    ```http
    Content-Security-Policy: default-src 'self'
    ```

### CSRF 防护

- **后端接口校验 Referer/Origin**
- **使用 CSRF Token**
  - 前端每次请求带上唯一 Token，后端验证。
- **Cookie 设置 SameSite 属性**
  - 例：
    ```http
    Set-Cookie: sessionid=xxx; SameSite=Strict
    ```

### 敏感信息泄露防护

- **前端代码构建去除敏感信息**（API Key、密钥等不出现在源码）
- **敏感信息不入 URL/query，不写入 localStorage/sessionStorage**
- **生产环境关闭详细报错、调试日志**
- **接口返回严格脱敏**

### 依赖库/第三方 SDK 安全

- **锁定依赖版本，定期升级，关注安全公告**
- **使用 npm audit、Snyk 等工具扫描依赖漏洞**
- **第三方 SDK 只引自可信源，必要时本地托管**
- **限制第三方脚本权限，CSP 白名单管理**

### 点击劫持防护

- **X-Frame-Options 响应头禁用 iframe 嵌入**
  - 例：
    ```http
    X-Frame-Options: DENY
    ```
- **或使用 CSP 的 frame-ancestors 限定页面嵌入位置**

---

## 3. 富文本内容安全展示策略

1. **内容过滤**

   - 使用如 DOMPurify、sanitize-html 等库，白名单过滤富文本中的标签、属性，只保留安全内容。

2. **禁用 JS 脚本与内联事件**

   - 过滤 `<script>`, `onerror`, `onload` 等属性，防止事件注入。

3. **图片、媒体资源校验**

   - 校验 img、video 的 src，防止钓鱼链接或恶意请求。

4. **CSP 配合限制外部资源加载和脚本行为**

5. **预览区只以安全方式渲染 HTML**
   - 千万不要直接 innerHTML 插入未消毒的富文本。

---

## 4. 前端安全基线落地措施（进阶）

- **团队安全编码规范和培训**
  - 定期安全培训，沉淀最佳实践、代码检查项。
- **自动化安全扫描**
  - 项目集成 SAST（如 SonarQube）、依赖安全扫描（npm audit、Snyk）。
- **前端构建流程加安全校验**
  - 构建时自动清理 console/debug 信息、检测敏感数据。
- **接口安全基线协定**
  - 与后端约定所有接口需防 CSRF、鉴权、输出脱敏。
- **前后端协作下的响应头安全统一**
  - 强制所有页面输出 CSP、X-Frame-Options、X-XSS-Protection 等安全头。
- **上线前/定期安全测试与漏洞修复**
  - 定期渗透测试、白盒/黑盒检测。
- **富文本统一消毒组件接入**
  - 所有涉及富文本的业务场景强制集成消毒过滤库。

---

## 总结

Web 前端安全是全流程的系统工程，需从**编码、依赖、网络、展示**等多层防护。实际落地要工程化推进，配合安全规范、工具、自动化与团队意识，持续提升项目安全防线。
